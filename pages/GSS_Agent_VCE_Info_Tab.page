<!--
Component name :  GSS_Agent_VCE_Info_Tab

Author  : Accenture
Purpose : Page for VCE Information Tab : CR-00138097
Date    : 13-Jun-2016 
-->
<!--CR-00140332 :4-august-2016 - added Entitlement Name in banner -->

<apex:page sidebar="false" standardcontroller="case" extensions="GSS_Agent_VCE_Info_Tab_Controller" showHeader="true">

    <apex:includeScript value="{!$Resource.Support_Console_30_Integration}"/>
    <apex:includeScript value="{!$Resource.Soap_Ajax_30_Connection}"/>
    <apex:includeScript value="{!$Resource.Soap_Ajax_30_Apex}"/>
    <apex:includeScript value="{!$Resource.Js_Function}"/> 
    <apex:includeScript value="{!$Resource.jquery191}"/>
    
    <script>
        if(window.navigator.appName=='Microsoft Internet Explorer')
        {
            document.write('<style>.detailList .helpOrb {top: 0px;right: 0px;left: 0px;bottom: 0px;</style>');        
            document.write('<style>.platformversionclass{width:214px;height:22px;}</style>');
            document.write('<style>.workaroundclass{width:214px;height:40px !important;}</style>');  
        }
        else{
            document.write('<style>.detailList .helpOrb {top: -10px;right: 0px;left: 0px;bottom: 0px;</style>');
            document.write('<style>.platformversionclass{width:218px;height:22px;}</style>');
            document.write('<style>.workaroundclass{width:214px;height:40px !important;}</style>');  
        }
    </script>
    
    <style>
         body { background-color: {!TabColor} !important; } 
         div { background-color: {!TabColor} !important; } 
         span { background-color: {!TabColor} !important; } 
         table { background-color: {!TabColor} !important; } 
         td { background-color: {!TabColor} !important; } 
         tr { background-color: {!TabColor} !important; } 
         th { background-color: {!TabColor} !important; } 
         border { background-color: {!TabColor} !important; } 
        
        .helpOrb {
            background-image: url(/img/help/helpOrbs.gif);
            background-position: 0 0;
            width: 20px;
            height: 15px;

        }
        .helpText {
            background-color: white !important;
        }
        
        *{
            font-size:12px;
        }
        .btn{
            font-size:10px !important;
        }
   
        option,select,textarea,input{
            font-size:13px !important;
        }
        select option, select optgroup {
            font-size: 85% !important;
        }  
    </style>
    
    <script type="text/javascript">
        function FocusSave(){
            savethecase();
        }
    </script>
    
    <apex:form id="formid"> 
        <apex:actionFunction name="saveContact" action="{!saveContact}" rerender="messages" status="counterStatus" />
        <apex:actionFunction name="savethecase" action="{!savecase}" rerender="messages" status="counterStatus" />
        <apex:pagemessages id="messages"></apex:pagemessages>   
        <div style="width:1200px;margin:0 auto;"> 
            <apex:pageBlock id="pb" title="" >  
                <script>
                    $('.pbHeader').remove();
                </script>
                <table align="center" width="90%"> 
                    <tr>
                        <td align="center">
                            <c:GSS_Agent_SRCommentsButton caseid="{!case.id}" customLabel="{!SRCommentButtonLabel}" Type="Internal Note VCE Info" rendered="{!isSRCommentButtonVisible}"/> 
                            
                            <c:GSS_Agent_SendEmailButton caseid="{!case.id}" customLabel="{!SendEmailButtonLabel}" SourceTab="VCE Info Email" email="{!case.Technical_Contact_Email__c}" rendered="{!isSendEmailButtonVisible}"/> 
                            
                            <c:GSS_Agent_CallOutboundButton caseid="{!case.id}" customLabel="{!CallOutboundButtonLabel}" phone="{!case.Technical_Contact_Phone__c}" casenumber="{!case.casenumber}" type="VCE" rendered="{!isCallOutboundButtonVisible}"/>  
                        
                            <c:GSS_Agent_Reassign caseid="{!case.id}" customLabel="{!ReassignButtonLabel}" rendered="{!isReassignButtonVisible}"/> 
                        
                            <c:GSS_Agent_Clone_SR_Button caseid="{!case.id}" customLabel="{!CloneButtonLabel}" rendered="{!isCloneButtonVisible}"/>
                        
                            <c:GSS_Agent_Webex_Button caseid="{!case.id}" customLabel="{!WebexButtonLabel}" casenumber="{!case.casenumber}" rendered="{!isWebexButtonVisible}"/> 
                        
                            <c:GSS_Agent_Public_Notes caseid="{!case.id}" customLabel="{!PublicCommentButtonLabel}" rendered="{!isPublicCommentButtonVisible}"/>

                            <c:GSS_Agent_Search_iKB casenumber="{!case.casenumber}" customLabel="{!KBButtonLabel}" KBString="{!Case.KB_SearchString__c}" rendered="{!isKBButtonVisible}"/>
                        
                            <c:GSS_Agent_Script_Server_Attachments casenumber="{!case.casenumber}" customLabel="{!ScriptsButtonLabel}" rendered="{!isScriptsButtonVisible}"/>                
                        
                            <c:GSS_Agent_Bugzilla customLabel="{!BugzillaButtonLabel}" rendered="{!isBugzillaButtonVisible}"/>                   
                        
                            <c:GSS_Agent_Upload_Attachments caseid="{!case.id}" customLabel="{!AttachmentButtonLabel}" casenumber="{!case.casenumber}" rendered="{!isAttachmentButtonVisible}"/>                 
                        
                            <c:GSS_Agent_LogACallButton caseid="{!case.id}" customLabel="{!LogACallButtonLabel}" rendered="{!isLogACallButtonVisible}"/> 
                        
                            <c:GSS_Agent_AddSRTeamMembers caseid="{!case.id}" customLabel="{!SRTeamButtonLabel}" rendered="{!isSRTeamButtonVisible}"/>
                            
                            <c:GSS_Agent_URL_Button caseid="{!case.id}" customLabel="{!SRLinkLabel}" rendered="{!isSRLinkVisible}"/>
                            
                            <c:GSS_Agent_AuditHistory caseid="{!case.id}" customLabel="{!HistoryLabel}" rendered="{!isHistoryVisible}"/>
                            
                            <c:GSS_Agent_Task_Button caseid="{!case.id}" customLabel="{!TaskLabel}" rendered="{!isTaskVisible}" /> 
                            
                            <c:GSS_Agent_VCE_Note_Button caseid="{!case.id}" customLabel="{!NoteLabel}" rendered="{!isNoteVisible}" />
                            
                            <c:GSS_Agent_VCEAttachment_Button caseid="{!case.id}" customLabel="{!AttachmentLabel}" rendered="{!isAttachmentVisible}" />
                            
                            <apex:commandbutton value="Save Contact" onclick="savethecontact()" oncomplete="refreshInfoContact()"/>
             
                        </td>
                    </tr>
                    <tr>
                        <td align="left" height="20px">
                            <apex:outputPanel id="counterid" layout="block">
                                    <apex:actionStatus startText=" Save is in progress..." stoptext="" id="counterStatus" startStyle="color:red;font-weight:bold;"/>
                            </apex:outputPanel> 
                        </td>
                    </tr>
               </table>
               
               <table width="90%" align="center">
                    <tr>
                        <td colspan="2">
                            <c:GSS_Agent_SR_Technical_Contact techCon="{!case.Technical_Contact_Name__c}" CaseNumber="{!case.casenumber}" Account="{!case.Account.Name}" AccountId="{!case.AccountId}" Synopsis="{!case.TSE_Synopsis__c}" EAName="{!case.EA_Name__c}" EANumber="{!case.EA_Number__c}" EntitleMentName="{!case.Entitlement.Name}"/> <!--CR-00140332-->
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            <br/><br/>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <table align="left" cellspacing="0" cellpadding="0" style="margin-left:-1px">
                                <apex:variable var="count" value="{!1}"/>
                                <apex:repeat id="repeat1" value="{!wrapperList}" var="f">
                                    <tr>
                                        <th class="labelCol fontsize" valign="top"> 
                                            <apex:outputLabel value="{!f.label}"/>
                                            <span class="helpButton" id="example{!count}-title-_help" style="{!if(f.helpText!='','display:inline','display:none')}">
                                                <img src="/s.gif" class="helpOrb" style="{!if(f.helpText!='','display:inline','display:none')}"/>

                                                <script type="text/javascript">      
                                                    sfdcPage.setHelp('example{!count}-title', '{!f.helpText}');       
                                                </script>
                                            </span>
                                            <apex:variable var="count" value="{!count + 1}"/>
                                        </th>
                                        <td class="data2Col" style="{!if(f.readOnly,'display:none','display:inline-block')}" > 
                                            <apex:inputField value="{!Case[f.fieldName]}" styleClass="{!f.fieldName}" required="{!f.required}" style="{!f.style};" onchange="FocusSave()"/>
                                        </td>  
                                        <td class="data2Col" style="{!if(f.readOnly,'display:inline-block','display:none')}">
                                            <apex:inputText value=" {!Case[f.fieldName]}" rendered="{!IF(f.readOnly==true && case[f.fieldname]!=null,true,false)}" disabled="true" style="{!f.style}" /> 
                                            <apex:inputText value="{!Case[f.fieldName]}" rendered="{!IF(f.readOnly==true && case[f.fieldname]==null,true,false)}" disabled="true" style="{!f.style}" />
                                        </td>   
                                    </tr>     
                                </apex:repeat>
                            </table>
                        </td>
                        <td valign="top">
                            <table align="left" cellspacing="0" cellpadding="0" style="margin-left:-1px">
                                <apex:variable var="count" value="{!50}"/>
                                <apex:repeat id="repeat2" value="{!wrapperListSecond}" var="f">
                                    <tr>
                                        <th class="labelCol fontsize" valign="top">        
                                            <apex:outputLabel value="{!f.label}"/>
                                            <span class="helpButton" id="example{!count}-title-_help" style="{!if(f.helpText!='','display:inline','display:none')}">
                                                <img src="/s.gif" class="helpOrb" style="{!if(f.helpText!='','display:inline','display:none')}"/>

                                                <script type="text/javascript">      
                                                    sfdcPage.setHelp('example{!count}-title', '{!f.helpText}');       
                                                </script>
                                            </span>
                                            <apex:variable var="count" value="{!count + 1}"/>
                                        </th>
                                        <td class="data2Col" style="{!if(f.readOnly,'display:none','display:inline-block')}" > 
                                            <apex:inputField value="{!Case[f.fieldName]}" styleClass="{!f.fieldName}" required="{!f.required}" style="{!f.style};" onchange="FocusSave()" />
                                        </td>
                                        <td class="data2Col" style="{!if(f.readOnly,'display:inline-block','display:none')}">
                                            <apex:inputText value=" {!Case[f.fieldName]}" rendered="{!IF(f.readOnly==true && case[f.fieldname]!=null,true,false)}" disabled="true" style="{!f.style}" /> 
                                            <apex:inputText value="{!Case[f.fieldName]}" rendered="{!IF(f.readOnly==true && case[f.fieldname]==null,true,false)}" disabled="true" style="{!f.style}" />
                                        </td>
                                    </tr>    
                                </apex:repeat>
                            </table>
                        </td>
                    </tr>
                </table>
            </apex:pageBlock>
        </div>
    </apex:form>
    <script type="text/javascript">
        var primarytab_id;
        function savethecontact() { 
            sforce.console.getEnclosingPrimaryTabId(getID);
            saveContact();
        }
        var getID= function getID(result1) { 
            primarytab_id=result1.id;
        };
        function refreshInfoContact(){
            alert('Contact copied successfully');
            sforce.console.refreshPrimaryTabById(primarytab_id, false);
        }
    </script>
</apex:page>